const attackBoxEl=document['querySelector']('#room-attackbox'),roomContentEl=document['querySelector']('#room-content'),roomGridContentEl=document['querySelector']('#room-content-main'),roomGridAttackboxEl=document['querySelector']('#room-content-attackbox'),attackBoxLoadingEl=document['querySelector']('#room-attackbox-loading'),attackBoxVMViewEl=document['querySelector']('#room-attackbox-vm-view'),attackBoxInstanceEl=document['querySelector']('#attackbox-machine-instance'),attackBoxURLBtn=document['querySelector']('#room-attackbox-url'),attackBoxExpireTxt=document['querySelector']('#room-attackbox-expire-text'),attackBoxStartBtn=document['querySelector']('#browser-machine-start');let attackBox={'uploadId':'5f39eb6342e1ab8a6d900ba3','roomCode':'freeattackbox'};subscribed=='1'&&(attackBox={'uploadId':'5f39eb6342e1ab8a6d900ba3','roomCode':'kali'});let loading={'deploying':![]},attackBoxExpireTimer;function startAttackBox(){!loading['deploying']?(loading['deploying']=!![],$['post']('/account/dashboard/deploy-kali'),displayMessages('','warning','Starting\x20your\x20machine..\x20please\x20wait!'),$['post']('/deploy',{'id':attackBox['uploadId'],'roomCode':attackBox['roomCode']},async function(_0x6da09a){_0x6da09a['success']?(setAttackBoxDetails('online'),renderAttackBox(_0x6da09a['title'],_0x6da09a['internalIP'],_0x6da09a['expires'],_0x6da09a['created'],_0x6da09a['remote'],_0x6da09a['username'],_0x6da09a['password'],_0x6da09a['waitTime']),displayMessages('Hooray!','success',_0x6da09a['msg']),showAttackBoxBtn('none'),setNavConnStatus({'type':'attackbox','virtualIP':_0x6da09a['remote']['privateIp']})):displayMessages('Uh-oh!','danger',_0x6da09a['msg']),loading['deploying']=![];})):displayMessages('','warning','Please\x20wait,\x20your\x20machine\x20is\x20still\x20loading..');}function terminateAttackBox(){displayMessages('','warning','Shutting\x20your\x20machine\x20down...'),$['post']('/api/vm/terminate',{'code':attackBox['roomCode']},async function(_0x44b09c){clearInterval(attackBoxExpireTimer),getNavConnOpenVPN(),_0x44b09c['success']?(displayMessages('','success',_0x44b09c['msg']),setAttackBoxDetails('offline'),showAttackBoxBtn('start')):displayMessages('Uh-oh!','warning',_0x44b09c['msg']);});}function extendAttackBox(){$['post']('/api/vm/renew',{'code':attackBox['roomCode']},async function(_0x28b6b3){_0x28b6b3['success']?(displayMessages('','success','Successfully\x20updated\x20your\x20machines\x20expiry\x20time.'),clearInterval(attackBoxExpireTimer),attackBoxExpireTimer=startAttackBoxTimer(_0x28b6b3['timeInSeconds'],attackBoxExpireTxt,'my-machine',attackBoxExpireTimer)):displayMessages('Uh-oh!','warning',_0x28b6b3['msg']);});}async function getAttackBoxStatus(){const _0x231374=await getRunningInstances(attackBox['roomCode']);_0x231374['success']?(getCookie('splitview')==''?(console['log']('Rendering\x20split\x20screen\x20AttackBox'),setAttackBoxDetails('online'),renderAttackBox(_0x231374['data']['title'],_0x231374['data']['internalIP'],_0x231374['data']['timeInSeconds'],_0x231374['data']['created'],_0x231374['data']['remote'],_0x231374['data']['credentials']['username'],_0x231374['data']['credentials']['password'],_0x231374['data']['waitTime']),showAttackBoxBtn('none')):showAttackBoxBtn('split'),setNavConnStatus({'type':'attackbox','virtualIP':_0x231374['data']['remote']['privateIp']})):(showAttackBoxBtn('start'),getNavConnOpenVPN());}function showAttackBoxBtn(_0x44999b){if(_0x44999b=='split')attackBoxStartBtn['style']['display']='inline-block',attackBoxStartBtn['textContent']='Show\x20AttackBox',attackBoxStartBtn['onclick']=function(){setCookie('splitview','',0xe),getAttackBoxStatus();};else{if(_0x44999b=='none')attackBoxStartBtn['style']['display']='none';else _0x44999b=='start'&&(attackBoxStartBtn['style']['display']='inline-block',attackBoxStartBtn['innerHTML']='<i\x20class=\x22far\x20fa-laptop\x22></i>\x20Start\x20AttackBox',attackBoxStartBtn['onclick']=function(){setCookie('splitview','',0xe),startAttackBox();});}}function exitViewAttackBox(){setCookie('splitview','full_screen',0xe),setAttackBoxDetails('offline'),showAttackBoxBtn('split');}getAttackBoxStatus();function setAttackBoxDetails(_0x20148b){_0x20148b=='online'?(roomContentEl['className']='room-flex',roomGridContentEl['className']='room-content',roomGridAttackboxEl['className']='room-attackbox',attackBoxLoadingEl['style']['display']='block',attackBoxEl['style']['display']='grid',toggleSidebar('close'),navbarLite('lite')):(attackBoxEl['style']['display']='none',roomContentEl['className']='',roomGridContentEl['className']='',roomGridContentEl['style']='',roomGridAttackboxEl['className']='',attackBoxVMViewEl&&(attackBoxVMViewEl['innerHTML']='',attackBoxVMViewEl['style']['height']=''),toggleSidebar('auto'),navbarLite('regular'));}function renderAttackBox(_0x365d0e,_0x43b95d,_0x18724f,_0x31c301,_0x39d849,_0x56ff02,_0x925600,_0x3b588e){clearInterval(attackBoxExpireTimer),attackBoxExpireTimer=startAttackBoxTimer(_0x18724f,attackBoxExpireTxt,'my-machine',attackBoxExpireTimer),checkAttackBoxDeploy(_0x365d0e,_0x43b95d,_0x18724f,_0x31c301,_0x39d849);}function checkAttackBoxDeploy(_0x55d71e,_0x573a13,_0x5c1fa8,_0x52cf94,_0x415e48){if(_0x415e48['active']){let _0x243574=0x1;_0x415e48['bootTime']&&(_0x243574=_0x415e48['bootTime']);const _0x10e549=_0x415e48['remoteUrl'];attackBoxURLBtn['href']=_0x10e549,attackBoxTimer(_0x52cf94,_0x243574,'deploy-browser',_0x10e549),attackBoxLoadingEl['innerHTML']='<div\x20id=\x22machine-loading-attackbox\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22progress-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22loading-msg\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x27mb-0\x27>Your\x20AttackBox\x20is\x20initializing...</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x27mb-0\x20faded\x27>Use\x20this\x20to\x20attack\x20machines\x20you\x20deploy\x20on\x20TryHackMe</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22progress\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22machine-loading-attackbox-progress\x22\x20class=\x22progress-bar\x20bg-success\x22\x20style=\x22width:0%\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}}let attackBoxInitCounter;async function attackBoxTimer(_0x2d1144,_0x150608,_0x39afa6,_0xe51a28){var _0x4bc855=new Date(_0x2d1144);_0x4bc855['setMinutes'](_0x4bc855['getMinutes']()+_0x150608);attackBoxInitCounter&&clearInterval(attackBoxInitCounter);const _0x36075c=await getServerTime();let _0x39504f=((_0x4bc855['getTime']()-_0x36075c['getTime']())/0x3e8)['toFixed'](0x0);attackBoxInitCounter=setInterval(function(){attackBoxURLBtn['className']='clear-link\x20disabled',attackBoxURLBtn['innerHTML']='<div\x20class=\x27faded\x27>Access\x20desktop\x20in\x20'+_0x39504f+'s</div>';const _0x3454c6=document['querySelector']('#machine-loading-attackbox-progress'),_0x1ae582=((0x1-(_0x39504f/(_0x150608*0x3c))['toFixed'](0x2))*0x64)['toFixed'](0x0);_0x3454c6['style']['width']=_0x1ae582+'%',_0x3454c6['textContent']=_0x1ae582+'%',_0x39504f--,_0x39504f<0x0&&(clearInterval(attackBoxInitCounter),document['querySelector']('#machine-loading-attackbox')['outerHTML']='',attackBoxURLBtn['className']='clear-link',attackBoxURLBtn['innerHTML']='<div><i\x20class=\x22far\x20fa-expand-alt\x22></i></div>',attackBoxVMViewEl['innerHTML']='<iframe\x20style=\x22position:\x20static;\x22\x20id=\x22remote-connection-2\x22\x20onmouseover=\x22setRemote2ConnectionFocus()\x22\x20src=\x22'+_0xe51a28+'\x22\x20width=\x22100%\x22\x20height=\x22100%\x22\x20frameBorder=\x220\x22\x20allow=\x22fullscreen\x22>Browser\x20not\x20compatible.</iframe>',attackBoxVMViewEl['style']['height']='100%',attackBoxLoadingEl['style']['display']='none');},0x3e8);}function setRemote2ConnectionFocus(){document['querySelector']('#remote-connection-2')['contentWindow']['focus']();}function startAttackBoxTimer(_0x35d6da,_0x48de72,_0x35f312,_0x3b6166){let _0x47ea08=parseInt(_0x35d6da),_0x158c0e=_0x47ea08,_0x593f87,_0x5139a5,_0x24012e;return _0x3b6166=setInterval(function(){_0x593f87=parseInt(_0x158c0e/0x3c,0xa)%0x3c,_0x5139a5=parseInt(_0x158c0e%0x3c,0xa),_0x24012e=parseInt(_0x158c0e/0xe10,0xa),_0x593f87=_0x593f87<0xa?'0'+_0x593f87:_0x593f87,_0x5139a5=_0x5139a5<0xa?'0'+_0x5139a5:_0x5139a5,_0x24012e=_0x24012e<0xa?'0'+_0x24012e:_0x24012e;let _0x5f0ccd=parseInt(_0x24012e)['toFixed'](0x0)+'h\x20'+_0x593f87+'m\x20'+_0x5139a5+'s';_0x24012e==0x0&&(_0x5f0ccd=_0x593f87+'m\x20'+_0x5139a5+'s'),_0x48de72['textContent']=_0x5f0ccd,--_0x158c0e<0x0&&(_0x158c0e=_0x47ea08);},0x3e8),_0x3b6166;}function navbarLite(_0x4bacda){const _0x53a8f8=document['querySelector']('.navbar-main'),_0x36cbca='navbar-lite';if(_0x4bacda=='lite'){if(!_0x53a8f8['className']['includes'](_0x36cbca))_0x53a8f8['classList']['toggle'](_0x36cbca);}else{if(_0x53a8f8['className']['includes'](_0x36cbca))_0x53a8f8['classList']['toggle'](_0x36cbca);}}